# 한진택배 송장번호 일괄 처리 시스템 - 사용자 가이드

**버전**: 1.0.0  
**작성일**: 2025-01-26

---

## 📚 목차

1. [시작하기 전에](#시작하기-전에)
2. [1단계: 드라이버 설치](#1단계-드라이버-설치)
3. [2단계: 모바일 앱 설치](#2단계-모바일-앱-설치)
4. [3단계: PC 프로그램 설치 및 실행](#3단계-pc-프로그램-설치-및-실행)
5. [4단계: 프로그램 사용법](#4단계-프로그램-사용법)
6. [자주 묻는 질문 (FAQ)](#자주-묻는-질문-faq)
7. [문제 해결](#문제-해결)

---

## 시작하기 전에

### 필요한 준비물

✅ **하드웨어**
- ESP32 개발 보드 (AI BOT) - USB-C 케이블 포함
- Windows PC (Windows 10/11 권장)
- 안드로이드 스마트폰 또는 태블릿 (Android 5.0 이상)

✅ **소프트웨어**
- PC 프로그램 실행 파일: `송장번호일괄처리시스템.exe`
- 모바일 앱: `app-debug.apk` (또는 Google Play에서 설치)

✅ **기타**
- 인터넷 연결 (초기 로그인 및 토큰 발급용)
- 엑셀 파일 (송장번호가 포함된 파일)

### 전체 설치 순서

1. ✅ ESP32 드라이버 설치
2. ✅ 모바일 앱 설치
3. ✅ PC 프로그램 실행 파일 복사
4. ✅ 프로그램 실행 및 로그인
5. ✅ ESP32와 PC 연결
6. ✅ 모바일 앱에서 ESP32에 토큰 전송
7. ✅ 송장번호 엑셀 파일 준비
8. ✅ 자동화 실행

---

## 1단계: 드라이버 설치

ESP32를 PC에 연결하기 위해서는 **CH340 USB-to-Serial 드라이버**가 필요합니다.

### Windows 10/11 사용자 (대부분 자동 인식)

1. **ESP32를 PC에 USB-C 케이블로 연결**
2. **장치 관리자 확인**:
   - `Win + X` 키 누르기
   - **장치 관리자** 선택
   - **포트(COM & LPT)** 항목 펼치기
   - ✅ **USB-SERIAL CH340 (COMx)** 표시되면 → **드라이버 설치 완료!**
   - ❌ **알 수 없는 장치** 또는 **느낌표(!)** 표시되면 → 드라이버 설치 필요

### 드라이버 수동 설치 방법

#### 방법 1: 제공된 설치 파일 사용 (가장 간단)

1. 프로그램 패키지에 포함된 `CH341SER.EXE` 파일을 찾습니다
2. 파일을 **더블클릭**하여 실행
3. 관리자 권한 요청 시 **예** 클릭
4. **INSTALL** 버튼 클릭
5. "The driver has been installed successfully!" 메시지 확인
6. PC를 재부팅 (선택사항이지만 권장)

#### 방법 2: 공식 사이트에서 다운로드

1. **WCH 공식 사이트 방문**: http://www.wch.cn/downloads/CH341SER_EXE.html
2. **CH341SER.EXE** 파일 다운로드
3. 위의 방법 1과 동일하게 설치

### 설치 확인

**장치 관리자에서 확인**:
- `Win + X` → **장치 관리자** → **포트(COM & LPT)**
- ✅ **USB-SERIAL CH340 (COM3)** 같은 항목이 보이면 성공
- **COM 번호를 기록**해두세요 (예: COM3, COM5 등)

**참고**: COM 포트 번호는 PC마다 다를 수 있으며, 같은 PC에서도 USB 포트에 따라 달라질 수 있습니다. 이것은 정상입니다.

### 드라이버 설치 문제 해결

#### 문제 1: "INSTALL" 버튼이 비활성화됨
**해결**:
- ESP32를 PC에서 **분리**한 상태에서 드라이버 설치
- 설치 완료 후 ESP32 다시 연결

#### 문제 2: 설치 후에도 인식 안 됨
**해결**:
1. ESP32를 **분리**
2. **장치 관리자** → **보기** → **숨겨진 장치 표시**
3. **알 수 없는 장치** 또는 **느낌표(!)** 항목 찾기
4. **우클릭** → **제거** (드라이버도 함께 제거 옵션 체크)
5. PC **재부팅**
6. ESP32 다시 연결

#### 문제 3: 드라이버 서명 오류 (Windows 10/11)
**해결**:
1. **시작 메뉴** → **설정** → **업데이트 및 보안**
2. **복구** → **고급 시작** → **지금 다시 시작**
3. **문제 해결** → **고급 옵션** → **시작 설정** → **다시 시작**
4. **F7 키** 눌러서 **드라이버 서명 적용 안 함** 선택
5. PC 재부팅 후 드라이버 재설치

---

## 2단계: 모바일 앱 설치

모바일 앱을 설치하여 ESP32에 인증 토큰을 전송할 수 있습니다.

### 방법 1: APK 파일로 직접 설치 (권장)

#### 1단계: APK 파일 준비

1. 프로그램 패키지에 포함된 `app-debug.apk` 파일을 찾습니다
2. 파일을 안드로이드 기기로 전송:
   - **USB 케이블**로 복사
   - **이메일**로 전송
   - **클라우드 스토리지** (Google Drive, OneDrive 등) 사용
   - **메신저** (카카오톡, 텔레그램 등)로 전송

#### 2단계: 설치 허용 설정

1. 안드로이드 기기에서 **설정** 앱 열기
2. **보안** 또는 **개인정보 보호** 메뉴 찾기
3. **알 수 없는 소스에서 앱 설치** 또는 **알 수 없는 앱 설치** 옵션 찾기
4. 파일을 받은 앱 (예: 파일 관리자, 이메일 앱)에서 **허용** 선택

**Android 8.0 이상**:
- 각 앱별로 설정해야 합니다
- 예: 파일 관리자에서 APK를 열면 "이 출처 허용" 토글 켜기

#### 3단계: APK 설치

1. APK 파일을 **탭(클릭)**하여 실행
2. **설치** 버튼 클릭
3. 설치 완료 후 **열기** 또는 **완료** 클릭

### 방법 2: Android Studio를 통한 설치 (개발자용)

개발 환경이 있다면 Android Studio를 통해 직접 설치할 수 있습니다.

1. Android Studio에서 프로젝트 열기
2. USB 케이블로 안드로이드 기기 연결
3. **USB 디버깅 허용** (처음 연결 시)
4. 실행 버튼(▶) 클릭

자세한 내용은 `mobile_app/실제_기기_연결_방법.md` 문서를 참고하세요.

### 설치 확인

1. 안드로이드 기기에서 앱 목록 확인
2. **"한진택배 스캐너"** 또는 앱 이름이 보이면 설치 완료

### 앱 사용 전 준비사항

✅ **블루투스 활성화**:
- 안드로이드 기기 설정 → **블루투스** 켜기

✅ **위치 정보 권한** (Android 6.0 이상):
- 앱 실행 시 위치 정보 권한 요청 → **허용** 선택
- 블루투스 스캔에 필요합니다

✅ **인터넷 연결**:
- 초기 로그인 및 토큰 발급에 필요합니다

---

## 3단계: PC 프로그램 설치 및 실행

PC 프로그램은 **설치가 필요 없습니다**. 실행 파일만 있으면 됩니다.

### 1단계: 실행 파일 복사

1. 프로그램 패키지에 포함된 `송장번호일괄처리시스템.exe` 파일을 찾습니다
2. 원하는 위치에 복사 (예: 바탕화면, 문서 폴더)
3. 필요시 바탕화면에 바로가기 생성

**참고**: 
- 프로그램은 `config` 폴더에 설정 파일을 자동 생성합니다
- 처음 실행 시 설정 폴더가 생성되므로, 실행 파일이 있는 위치가 중요합니다

### 2단계: 프로그램 실행

1. **송장번호일괄처리시스템.exe** 파일을 **더블클릭**
2. 바이러스 백신 경고가 나타날 수 있음:
   - 이는 정상적인 현상입니다 (실행 파일이므로)
   - **추가 정보** → **실행 허용** 선택
   - 계속 경고가 나타나면 바이러스 백신 예외 목록에 추가

### 3단계: 초기 설정 확인

프로그램을 처음 실행하면 다음을 확인하세요:

1. **로그인 화면**이 나타나는지 확인
2. **COM 포트 설정**이 표시되는지 확인 (ESP32 연결 후)

---

## 4단계: 프로그램 사용법

### 4.1 첫 실행 및 로그인

#### 4.1.1 회원가입 (처음 사용하는 경우)

1. 프로그램 실행 시 **로그인 화면**이 나타납니다
2. **회원가입** 탭 클릭
3. 다음 정보 입력:
   - **아이디**: 로그인에 사용할 ID (영문, 숫자)
   - **비밀번호**: 안전한 비밀번호 설정
   - **이름**: 본인 이름
   - **이메일**: (선택사항) 이메일 주소
   - **전화번호**: (선택사항) 전화번호
4. **회원가입** 버튼 클릭
5. "회원가입이 완료되었습니다. 관리자 승인 후 이용 가능합니다." 메시지 확인
6. **관리자 승인**을 기다립니다 (관리자가 승인하면 사용 가능)

#### 4.1.2 로그인

1. **로그인** 탭에서:
   - **아이디** 입력
   - **비밀번호** 입력
2. **로그인** 버튼 클릭
3. 로그인 성공 시 **메인 화면**으로 이동

**⚠️ 중요**: 
- 로그인 후 **1시간 후 자동 로그아웃**됩니다
- 프로그램을 계속 사용하려면 다시 로그인해야 합니다

### 4.2 ESP32 연결

#### 4.2.1 ESP32를 PC에 연결

1. ESP32를 **USB-C 케이블**로 PC에 연결
2. ESP32의 **전원 LED**가 켜지는지 확인
3. 프로그램이 실행 중이라면 **"새로고침"** 버튼 클릭

#### 4.2.2 COM 포트 선택

1. 프로그램 상단의 **설정** 영역에서 **포트** 드롭다운 메뉴 클릭
2. 목록에서 ESP32의 포트 선택:
   - 보통 **USB-SERIAL CH340 (COMx)** 형태로 표시됩니다
   - 예: COM3, COM5, COM7 등
3. 포트를 잘 모르겠다면:
   - **"새로고침"** 버튼 클릭하여 목록 업데이트
   - 각 포트를 선택해보면서 **"연결 확인"** 버튼으로 테스트

#### 4.2.3 연결 확인

1. **"연결 확인"** 버튼 클릭
2. ✅ **"BLT AI 로봇 연결됨"** 메시지가 나타나면 성공!
3. ❌ **"연결 실패"** 메시지가 나타나면:
   - 다른 COM 포트 선택
   - ESP32 연결 확인
   - 드라이버 설치 확인

### 4.3 모바일 앱에서 토큰 전송

#### 4.3.1 모바일 앱 실행 및 로그인

1. 안드로이드 기기에서 **한진택배 스캐너** 앱 실행
2. **아이디**와 **비밀번호** 입력 (PC 프로그램과 동일한 계정)
3. **로그인** 버튼 클릭
4. 로그인 성공 시 토큰이 자동으로 발급됩니다

#### 4.3.2 ESP32 블루투스 스캔

1. 모바일 앱에서 **"ESP32 스캔"** 또는 **"블루투스 스캔"** 버튼 클릭
2. **블루투스 권한** 요청 시 **허용** 선택
3. **위치 정보 권한** 요청 시 **허용** 선택 (블루투스 스캔에 필요)
4. ESP32 장치가 목록에 나타날 때까지 대기:
   - 장치 이름: **"한진택배 스캐너"** 또는 유사한 이름
5. 목록에서 **ESP32 장치 선택**

#### 4.3.3 토큰 전송

1. ESP32 장치를 선택하면 자동으로 연결 시도
2. 연결 성공 시 토큰이 자동으로 전송됩니다
3. ✅ **"토큰 전송 완료"** 메시지 확인

**⚠️ 중요**: 
- **PC 프로그램에 로그인한 사용자와 모바일 앱에 로그인한 사용자가 동일해야 합니다**
- 다른 사용자의 토큰으로는 작동하지 않습니다 (1인 1아이디 정책)

### 4.4 엑셀 파일 준비

#### 4.4.1 엑셀 파일 형식

프로그램은 다음 형식의 엑셀 파일을 읽을 수 있습니다:

- **파일 형식**: `.xlsx` 또는 `.xls`
- **시트 이름**: 첫 번째 시트 또는 "Sheet1" (기본값)
- **컬럼 이름**: **"InvoiceNumber"** (송장번호가 있는 컬럼)

**예시 엑셀 파일 구조**:

| InvoiceNumber |
|---------------|
| 1234567890123 |
| 2345678901234 |
| 3456789012345 |

#### 4.4.2 엑셀 파일 준비 팁

✅ **송장번호 형식**:
- 숫자만 있어도 됩니다 (예: 1234567890123)
- 텍스트로 저장되어도 됩니다 (예: "1234567890123")
- 앞자리 0이 있어도 보존됩니다 (예: 0012345678901)

❌ **주의사항**:
- 송장번호에 공백이나 특수문자가 있으면 제거하세요
- 한 행에 하나의 송장번호만 있어야 합니다
- 빈 행은 무시됩니다

### 4.5 자동화 실행

#### 4.5.1 엑셀 파일 업로드

1. 프로그램 메인 화면에서 **"찾아보기"** 버튼 클릭
2. 엑셀 파일 선택 (`.xlsx` 또는 `.xls` 파일)
3. **"파일 업로드"** 버튼 클릭
4. 파일 읽기 완료 시:
   - ✅ **"엑셀 파일이 로드되었습니다. 총 XX건의 송장번호를 확인했습니다."** 메시지 확인
   - 미리보기 영역에 송장번호 목록이 표시됩니다

#### 4.5.2 한진택배 모바일 앱 준비

**중요**: 자동화를 시작하기 전에 반드시 준비해야 합니다!

1. 안드로이드 기기에서 **한진택배 모바일 앱** 실행
2. **송장번호 입력 화면**으로 이동:
   - 예: "송장 등록", "송장번호 입력" 등
   - **입력 필드가 활성화**된 상태여야 합니다
3. **키보드가 나타나지 않은 상태**로 준비:
   - 입력 필드를 탭하지 마세요
   - 키보드가 나타나면 닫으세요
4. 모바일 기기를 **ESP32와 블루투스로 연결된 상태**로 유지

#### 4.5.3 자동화 시작

1. 프로그램에서 **"동기화 실행"** 버튼 클릭
2. 확인 메시지에서 **"예"** 클릭
3. **3초 카운트다운**이 시작됩니다:
   - 이 시간 동안 모바일 앱이 준비되었는지 확인하세요
4. 카운트다운이 끝나면 자동으로 송장번호 전송이 시작됩니다

#### 4.5.4 실행 중

**진행 상황 확인**:
- 프로그램 하단의 **진행 바**에서 진행률 확인
- **로그 영역**에서 각 송장번호의 처리 상태 확인:
  - ✅ 성공: 송장번호가 성공적으로 입력됨
  - ❌ 실패: 오류 발생 (자동 재시도)

**중단하기**:
- **"중지"** 버튼 클릭
- 또는 `ESC` 키 누르기

**완료**:
- 모든 송장번호가 처리되면 자동으로 완료됩니다
- 성공/실패 건수가 표시됩니다

### 4.6 설정 조정

#### 4.6.1 딜레이 설정

송장번호 입력 속도를 조정할 수 있습니다:

- **최소 딜레이**: 각 송장번호 입력 간 최소 대기 시간 (초)
- **최대 딜레이**: 각 송장번호 입력 간 최대 대기 시간 (초)

**권장값**:
- 기본값: 최소 1.0초, 최대 2.0초
- 입력이 너무 빠르면: 값 증가 (예: 최소 1.5초, 최대 3.0초)
- 입력이 너무 느리면: 값 감소 (예: 최소 0.5초, 최대 1.5초)

#### 4.6.2 설정 저장

1. 설정을 변경한 후
2. **"설정 저장"** 버튼 클릭 (있는 경우)
3. 또는 프로그램 종료 시 자동 저장

### 4.7 관리자에게 메시지 보내기

문제가 발생하거나 도움이 필요한 경우:

1. 프로그램 상단 메뉴에서 **"도움말"** → **"관리자에게 메시지 보내기"** 선택
2. 다음 정보 입력:
   - **종류**: 입금확인, 사용방법, 오류, 기타
   - **제목**: 문의 제목
   - **내용**: 자세한 내용
   - **회신받을 전화번호**: (선택사항)
3. **전송** 버튼 클릭
4. 관리자가 텔레그램으로 메시지를 받아 답변합니다

---

## 자주 묻는 질문 (FAQ)

### Q1: COM 포트가 보이지 않아요

**A**: 다음을 확인하세요:
1. ESP32가 PC에 제대로 연결되었는지 확인
2. ESP32 전원 LED가 켜져 있는지 확인
3. **"새로고침"** 버튼 클릭
4. Windows 장치 관리자에서 포트 확인
5. CH340 드라이버가 설치되어 있는지 확인

### Q2: "연결 실패" 메시지가 나타나요

**A**: 다음을 확인하세요:
1. 올바른 COM 포트를 선택했는지 확인
2. 다른 프로그램이 포트를 사용 중인지 확인 (Arduino IDE 시리얼 모니터 등)
3. ESP32를 분리했다가 다시 연결
4. PC 재부팅 후 재시도

### Q3: 송장번호가 입력되지 않아요

**A**: 다음을 확인하세요:
1. 모바일 앱이 **송장번호 입력 화면**에 있는지 확인
2. 입력 필드가 **활성화**되어 있는지 확인
3. 키보드가 **닫혀 있는지** 확인
4. 모바일 기기와 ESP32가 **블루투스로 연결**되어 있는지 확인
5. 모바일 앱에서 ESP32에 **토큰이 전송**되었는지 확인

### Q4: "로그인 실패" 메시지가 나타나요

**A**: 다음을 확인하세요:
1. 아이디와 비밀번호가 올바른지 확인
2. 인터넷 연결이 되어 있는지 확인
3. 관리자 승인이 완료되었는지 확인 (회원가입 직후)
4. 계정이 비활성화되지 않았는지 확인 (관리자에게 문의)

### Q5: 세션이 만료되었다고 나와요

**A**: 
- 로그인 후 **1시간이 지나면** 자동으로 로그아웃됩니다
- 다시 로그인하시면 됩니다

### Q6: 엑셀 파일을 읽을 수 없다고 나와요

**A**: 다음을 확인하세요:
1. 파일 형식이 `.xlsx` 또는 `.xls`인지 확인
2. 파일이 손상되지 않았는지 확인
3. 파일에 "InvoiceNumber" 컬럼이 있는지 확인
4. 다른 프로그램에서 파일을 열고 있지 않은지 확인

### Q7: 다른 PC에서 사용할 수 있나요?

**A**: 
- 네, 가능합니다
- 단, 각 PC에서:
  1. CH340 드라이버 설치 필요
  2. COM 포트 번호가 다를 수 있으므로 프로그램에서 선택 필요
  3. 동일한 계정으로 로그인 필요

### Q8: 여러 개의 ESP32를 사용할 수 있나요?

**A**: 
- 네, 가능합니다
- 각 ESP32는 다른 COM 포트로 인식됩니다
- 프로그램에서 사용할 ESP32의 COM 포트를 선택하면 됩니다

### Q9: 프로그램이 실행되지 않아요

**A**: 다음을 확인하세요:
1. Windows 10/11인지 확인 (권장)
2. 바이러스 백신에서 차단되지 않았는지 확인
3. 관리자 권한으로 실행 시도
4. 다른 PC에서 테스트

### Q10: 토큰이 전송되지 않아요

**A**: 다음을 확인하세요:
1. 모바일 앱에서 로그인이 되어 있는지 확인
2. 블루투스가 켜져 있는지 확인
3. 위치 정보 권한이 허용되어 있는지 확인
4. ESP32가 전원이 켜져 있고 블루투스 모드인지 확인
5. 모바일 기기와 ESP32가 가까이 있는지 확인

---

## 문제 해결

### 문제 1: 드라이버 설치 오류

**증상**: ESP32가 인식되지 않음, 장치 관리자에 느낌표 표시

**해결 방법**:
1. ESP32를 PC에서 분리
2. 장치 관리자에서 알 수 없는 장치 제거
3. PC 재부팅
4. CH341SER.EXE를 관리자 권한으로 실행하여 드라이버 재설치
5. ESP32 다시 연결

### 문제 2: COM 포트 접근 거부

**증상**: "포트를 사용할 수 없습니다" 오류

**해결 방법**:
1. 다른 프로그램이 포트를 사용 중인지 확인:
   - Arduino IDE 시리얼 모니터 닫기
   - 다른 시리얼 통신 프로그램 종료
2. 프로그램을 완전히 종료한 후 재실행
3. PC 재부팅

### 문제 3: 블루투스 연결 실패

**증상**: 모바일 앱에서 ESP32를 찾을 수 없음

**해결 방법**:
1. ESP32가 전원이 켜져 있는지 확인
2. 모바일 기기의 블루투스가 켜져 있는지 확인
3. 모바일 기기와 ESP32가 가까이 있는지 확인 (1미터 이내)
4. 모바일 기기 블루투스 설정에서 기존 ESP32 연결 삭제 후 재스캔
5. 모바일 앱 재시작

### 문제 4: 송장번호 입력이 빠르거나 느림

**증상**: 입력 속도가 적절하지 않음

**해결 방법**:
1. 프로그램의 **딜레이 설정** 조정:
   - 너무 빠르면: 최소/최대 딜레이 값 증가
   - 너무 느리면: 최소/최대 딜레이 값 감소
2. 설정 저장 후 재실행

### 문제 5: 일부 송장번호만 실패

**증상**: 대부분 성공하지만 일부만 실패

**해결 방법**:
1. 실패한 송장번호를 별도 엑셀 파일로 만들어 다시 시도
2. 모바일 앱이 정상 작동하는지 확인 (네트워크 연결 등)
3. 딜레이 시간을 조금 늘려서 재시도

### 문제 6: 프로그램이 응답하지 않음

**증상**: 프로그램이 멈춤, 버튼이 작동하지 않음

**해결 방법**:
1. **"중지"** 버튼 클릭 또는 `ESC` 키 누르기
2. 프로그램을 완전히 종료 (작업 관리자에서 강제 종료)
3. PC 재부팅
4. 프로그램 재실행

---

## 추가 정보

### 지원 및 문의

- **이메일**: pyo0829@gmail.com
- **프로그램 내 문의**: 도움말 → 관리자에게 메시지 보내기

### 버전 정보

- **프로그램 버전**: 1.0.0
- **최소 요구사항**: Windows 10, Android 5.0
- **권장 사양**: Windows 11, Android 8.0 이상

### 업데이트

- 프로그램 업데이트는 관리자가 배포합니다
- 업데이트 알림은 프로그램 실행 시 표시됩니다

---

**마지막 업데이트**: 2025-01-26  
**문서 버전**: 1.0.0

