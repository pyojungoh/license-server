# 사용자 가이드: COM 포트 선택 방법

## 🔌 COM 포트란?

COM 포트는 PC가 ESP32(AI BOT) 장치와 통신하기 위한 경로입니다. 
**각 PC마다, 또는 USB 포트마다 COM 포트 번호가 다를 수 있습니다.**

예:
- 개발자 PC에서: COM3
- 사용자 PC A에서: COM5
- 사용자 PC B에서: COM7
- 같은 PC, 다른 USB 포트: COM3 → COM8

## ✅ 해결 방법: 프로그램이 자동으로 감지합니다!

**걱정하지 마세요!** 프로그램은 시작할 때 자동으로 연결된 ESP32 장치를 찾아서 COM 포트 목록을 보여줍니다.

## 📋 COM 포트 선택 방법

### 1단계: ESP32 연결
1. ESP32를 USB 케이블로 PC에 연결
2. ESP32의 전원 LED가 켜지는지 확인

### 2단계: 프로그램 실행
1. **송장번호 일괄 처리 시스템** 프로그램 실행
2. 프로그램 시작 시 자동으로 COM 포트 목록을 스캔합니다

### 3단계: COM 포트 선택
1. **설정** 영역에서 **COM 포트** 드롭다운 메뉴 클릭
2. 목록에서 연결된 ESP32의 포트 선택
   - 보통 여러 개의 포트가 보입니다
   - ESP32가 연결되어 있으면 새로운 포트가 목록에 나타납니다
   - 예: COM3, COM4, COM5, **COM6** (새로 연결된 ESP32)

### 4단계: 새로고침 (필요 시)
만약 ESP32를 나중에 연결했다면:
1. **"새로고침"** 버튼 클릭
2. 새로 연결된 포트가 목록에 추가됩니다

### 5단계: 연결 확인
1. **"연결 확인"** 버튼 클릭
2. "BLT AI 로봇 연결됨" 메시지가 나타나면 성공!

## 💡 어느 포트를 선택해야 하나요?

### 방법 1: 새로고침으로 확인
1. **ESP32를 분리**한 상태에서 **"새로고침"** 클릭
2. 목록 확인 (포트 개수 확인)
3. **ESP32를 연결**한 후 **"새로고침"** 다시 클릭
4. **새로 추가된 포트**가 ESP32입니다

### 방법 2: 연결 확인으로 확인
1. 각 포트를 선택해보면서 **"연결 확인"** 클릭
2. "BLT AI 로봇 연결됨"이 나타나는 포트가 ESP32입니다

### 방법 3: Windows 장치 관리자 확인
1. **Windows 검색 → "장치 관리자"** 열기
2. **포트(COM & LPT)** 항목 펼치기
3. ESP32는 보통 다음과 같이 표시됩니다:
   - **CH340** (USB-SERIAL CH340)
   - **USB Serial Port (COMx)**
   - **Silicon Labs CP210x** (드물게)

## ⚠️ 주의사항

### 포트가 보이지 않을 때
1. **ESP32가 제대로 연결되었는지 확인**
   - USB 케이블이 단단히 연결되었는지 확인
   - ESP32 전원 LED가 켜져 있는지 확인

2. **USB 드라이버 설치 확인**
   - CH340 드라이버가 설치되어 있는지 확인
   - 없으면 `설치파일/CH341SER.EXE` 실행하여 설치

3. **"새로고침" 버튼 클릭**
   - ESP32를 연결한 후 반드시 새로고침 클릭

4. **다른 프로그램이 포트를 사용 중인지 확인**
   - Arduino IDE의 시리얼 모니터가 열려있으면 닫기
   - 다른 시리얼 통신 프로그램이 실행 중이면 종료

### 포트를 잘못 선택했을 때
- **문제 없습니다!** 다른 포트를 선택하면 됩니다
- 단, 잘못된 포트를 선택하면 "연결 실패" 메시지가 나타납니다
- 그러면 올바른 포트를 선택하세요

## 🔄 포트가 바뀌었을 때

### 상황 1: 같은 PC, 다른 USB 포트에 연결
- ESP32를 다른 USB 포트에 꽂으면 COM 포트 번호가 바뀔 수 있습니다
- **해결**: "새로고침" 버튼 클릭 → 새로운 포트 선택

### 상황 2: 다른 PC에서 사용
- 다른 PC에서는 당연히 COM 포트 번호가 다릅니다
- **해결**: 프로그램 실행 → 포트 목록에서 올바른 포트 선택

### 상황 3: 여러 ESP32를 같은 PC에서 사용
- 여러 개의 ESP32를 동시에 연결하면 각각 다른 포트를 사용합니다
- 예: COM3, COM4, COM5
- **해결**: 사용할 ESP32의 포트만 선택

## ✅ 체크리스트

처음 사용하는 사용자는 다음을 확인하세요:

- [ ] ESP32가 USB로 PC에 연결됨
- [ ] 프로그램 실행
- [ ] COM 포트 드롭다운에서 포트 선택
- [ ] "새로고침" 버튼으로 목록 업데이트 (필요 시)
- [ ] "연결 확인" 버튼으로 정상 연결 확인
- [ ] "BLT AI 로봇 연결됨" 메시지 확인

## 🎯 요약

1. ✅ **COM 포트는 PC마다 다릅니다** - 이는 정상입니다
2. ✅ **프로그램이 자동으로 감지**합니다 - 걱정할 필요 없습니다
3. ✅ **드롭다운에서 선택**만 하면 됩니다
4. ✅ **"새로고침"** 버튼으로 업데이트 가능합니다
5. ✅ **"연결 확인"** 버튼으로 정상 작동 확인합니다

---

**문제가 있으면:**
1. "새로고침" 버튼 클릭
2. "연결 확인" 버튼으로 테스트
3. Windows 장치 관리자에서 포트 확인


